MOD_DIR="${MODS_DIR}/blankstore"
MOD_APK="${MOD_DIR}/BlankStore.apk"

GEMINI_VENDOR="${ANDROID_ROOT}/vendor/xiaomi/gemini"

VENDOR_MK="${GEMINI_VENDOR}/gemini-vendor.mk"
ANDROID_MK="${GEMINI_VENDOR}/Android.mk"

MOD_APP="${GEMINI_VENDOR}/system/app/"
MOD_APP_APK="com.android.vending.apk"

out "App directory [${MOD_APP}]"
! d_exists "${MOD_APP}" && mkd "${MOD_APP}"

out "Copy Asset [${MOD_APK}]"
cp -v "${MOD_APK}" "${MOD_APP}/${MOD_APP_APK}"

append()
{
	echo "${@}"
	echo "${@}" >> "${ANDROID_MK}"
}

append ''
append 'ifeq ($(TARGET_DEVICE),gemini)'
append ''
append 'include $(CLEAR_VARS)'
append 'LOCAL_MODULE := com.android.vending'
append 'LOCAL_MODULE_OWNER := xiaomi'
append 'LOCAL_SRC_FILES := system/app/com.android.vending.apk'
append 'LOCAL_CERTIFICATE := platform'
append 'LOCAL_MODULE_TAGS := optional'
append 'LOCAL_MODULE_CLASS := APPS'
append 'LOCAL_MODULE_SUFFIX := .apk'
append 'LOCAL_PROPRIETARY_MODULE := true'
append 'LOCAL_MODULE_PATH := $(PRODUCT_OUT)/system/app'
append 'include $(BUILD_PREBUILT)'
append ''
append 'endif'
append ''

vappend()
{
	echo "${@}"
	echo "${@}" >> "${VENDOR_MK}"
}

vappend ''
vappend 'PRODUCT_PACKAGES += com.android.vending'
vappend ''
